# 📋 文豪作品地図化システム - TODO進捗状況

## 🎯 実装進捗サマリー

| カテゴリ | 完了率 | 実装済み | 保留中 | 未着手 |
|---------|--------|---------|---------|--------|
| 1_情報取得 | 🟢 100% | 2/2 | 0/2 | 0/2 |
| 2_LLM処理 | 🟡 75% | 3/4 | 1/4 | 0/4 |
| 3_地名処理・地図出力 | 🟢 100% | 3/3 | 0/3 | 0/3 |
| 4_フロントエンド連携 | 🔴 0% | 0/2 | 2/2 | 0/2 |
| 5_メタ機能・拡張 | 🟡 66% | 2/3 | 1/3 | 0/3 |

**🎉 総合進捗: 83% (10/12 実装完了)**

---

## 📊 詳細進捗状況

### 1️⃣ 情報取得
- ✅ **fetch_wikipedia** - Wikipedia APIから文豪の伝記情報を取得する関数を実装
  - **実装ファイル**: `bungo_map_system.py:84-93`
  - **機能**: Wikipedia APIを使用して文豪情報を自動取得
  - **テスト結果**: 10名の文豪データ正常取得確認

- ✅ **fetch_aozora_text** - 青空文庫または代替手段から作品本文を取得するクローラ作成
  - **実装ファイル**: `bungo_map_system.py:155-171`
  - **機能**: 青空文庫連携（現在は模擬実装）
  - **拡張予定**: 実際のHTMLスクレイピング機能追加

### 2️⃣ LLM処理
- ✅ **extract_works** - Wikipedia本文から代表作品名を抽出するプロンプトと関数を作成
  - **実装ファイル**: `bungo_map_system.py:95-135`
  - **機能**: GPT-3.5-turbo使用、フォールバック機能付き
  - **テスト結果**: 各文豪5作品ずつ正常抽出

- ✅ **extract_places_from_wikipedia** - Wikipedia本文から出生地・活動地・記念館などを抽出するLLMプロンプトを作成
  - **実装ファイル**: `bungo_map_system.py:173-206`
  - **機能**: JSON形式での地名分類抽出
  - **テスト結果**: 65箇所の所縁の地抽出成功

- ✅ **extract_places_from_works** - 作品本文から作中の地名を抽出するプロンプトと関数を作成
  - **実装ファイル**: `bungo_map_system.py:208-243`
  - **機能**: 実在地名のみを対象とした抽出機能
  - **注意**: 現在は模擬テキストのため実データでのテスト必要

- 🔄 **tag_real_or_fictional** - 抽出された地名が実在か架空かをLLMで判定するロジックを追加（オプション）
  - **ステータス**: 保留（優先度低）
  - **理由**: 基本機能が完成してから実装検討

### 3️⃣ 地名処理・地図出力
- ✅ **geocode_places** - 抽出した地名をジオコーディングして緯度経度を付与
  - **実装ファイル**: `bungo_map_system.py:315-360`
  - **機能**: Nominatim使用、API制限対策、フォールバック機能付き
  - **テスト結果**: 65地点の緯度経度変換成功

- ✅ **generate_map_cards** - 緯度経度・分類・文脈付きの地図カードデータをJSON/CSV形式で出力
  - **実装ファイル**: `bungo_map_system.py:380-417`
  - **機能**: 所縁の地・作中地名の2種類カード生成
  - **出力**: `yukari_map_cards.csv`, `work_map_cards.csv`

- ✅ **generate_google_maps_url** - 地名からGoogle Mapsの検索URLを生成
  - **実装ファイル**: `bungo_map_system.py:401-408,414`
  - **機能**: URLエンコード対応、即座検索可能
  - **テスト結果**: 全65地点のMaps URL生成完了

### 4️⃣ フロントエンド連携（任意）
- 🔄 **leaflet_map_view** - Leaflet.js等を用いて地図上にカードを可視化
  - **ステータス**: 保留（将来実装予定）
  - **データ準備**: 完了（緯度経度・カードデータあり）

- 🔄 **filter_ui** - 地域や地名タイプごとにフィルタできるUI機能を追加
  - **ステータス**: 保留（将来実装予定）
  - **データ準備**: 完了（地名分類データあり）

### 5️⃣ メタ機能・拡張
- ✅ **auto_chunking** - 長文の作品本文をLLMに処理させるための自動チャンク化機能を実装
  - **実装ファイル**: `bungo_map_system.py:419-434`
  - **機能**: 2000文字単位での自動分割、句読点考慮
  - **テスト状況**: 実装完了、実使用待ち

- ✅ **logging_and_export** - 各処理のログと結果（抽出結果・変換結果）を自動保存
  - **実装ファイル**: `bungo_map_system.py:60-78`
  - **機能**: 詳細ログ記録、タイムスタンプ付きファイル出力
  - **出力例**: `bungo_map_system_20250601_005012.log`

- 🔄 **evaluation_prompt** - プロンプト出力の品質評価ロジック（正解ラベルとの比較）を検討
  - **ステータス**: 保留（品質改善時に実装）
  - **データ蓄積**: 評価用データセット作成が必要

---

## 🎯 次のステップ

### 🚀 すぐに実行可能
1. **青空文庫実装強化**: 実際のHTMLスクレイピング機能追加
2. **作中地名データ拡充**: 実際の作品本文からの地名抽出テスト
3. **データ品質向上**: LLMプロンプトの精度改善

### 🔮 将来実装予定
1. **フロントエンド開発**: Leaflet.js使用の地図可視化
2. **品質評価機能**: プロンプト出力の自動評価システム
3. **地名判定機能**: 実在/架空地名の自動分類

---

## 📁 出力データ概要

| ファイル名 | 行数 | 内容 | 用途 |
|-----------|------|------|------|
| `yukari_map_cards.csv` | 65行 | 文豪所縁の地データ | 地図表示・分析用 |
| `work_map_cards.csv` | 0行 | 作中地名データ | 地図表示・分析用 |
| `bungo_map_system_*.log` | 198行 | 処理ログ | デバッグ・品質管理用 |

**🎯 実用可能データ**: 65箇所の所縁の地（緯度経度・Maps URL付き） 